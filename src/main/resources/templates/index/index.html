<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" 
                  xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8" name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/top_rate.css">
    <link rel="stylesheet" href="/css/now_playing.css">
    <link rel="stylesheet" href="/css/index.css">
    <link rel="stylesheet" href="/css/footer.css">
    <link rel="stylesheet" href="/css/header.css">
    <link rel="stylesheet" href="/css/scroll-to-top.css">
    <link rel="stylesheet" href="/css/MailForwarding.css">
    <link rel="stylesheet" href= "/css/latest_news.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%2210 0 100 100%22><text y=%22.90em%22 font-size=%2290%22>🎬</text></svg>">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/flickity@2/dist/flickity.min.css">
    
    <title>리뷰플러스</title>
</head>
<style>
#userProfilePicture{
	width: 50px;
	height: 50px;
	border-radius: 25px;
	border:1px solid white;
	object-fit:cover;
}
</style>

<body>
	<!--익명사용자(비로그인상태)isAnonymous -->
	<!--사용자(로그인상태)isAuthenticated -->
    <div id="header" th:fragment="header">                  
	        <a href="/" class="MainLogo">
	           <img th:src="@{/images/logo.png}" alt ="로고" >
	        </a>
       	<div sec:authorize="isAuthenticated()" class = "headerLeft">
       	
				<a href = "/UserMypage"><img
				    id = "userProfilePicture" th:src="@{'/images/profile/' + ${profileFileName}}" 
				    alt="프로필 사진" ></a>
				    
       			<!-- ROLE_DORMANT -->
			    <span sec:authorize="hasRole('ROLE_DORMANT')">
			        휴면계정
			    </span>
			    
	       		<!-- ROLE_ADMIN -->
			    <span sec:authorize="hasRole('ROLE_ADMIN')">
			        <span th:text = "${#authentication.principal.nickname}"></span>
			    </span>
			    
			    <!-- ROLE_USER -->
			    <span sec:authorize="hasRole('ROLE_USER')">
			       <span th:text = "${#authentication.principal.nickname}" ></span>
			    </span>
			    <span><a href="/MoviesList">인기</a></span>
			    <span><a href="/MoviesList?category=upcoming">개봉예정</a></span>
	    </div>
	    
	    
	    <!-- 헤더상단 메뉴 -->
	    <div sec:authorize="isAnonymous()" class = "headerLeft">
			    <span><a href="/MoviesList">인기</a></span>
			    <span><a href="/MoviesList?category=upcoming">개봉예정</a></span>
	    </div>
	    
	    
	    
		<!-- 헤더 오른쪽 상단 메뉴 -->	
	    <div class="headerRight">
				<div class ="userIndex" sec:authorize="isAnonymous()">
					<a href = "/UserLoginMain">로그인</a>
				</div>
			    <div>
				    <form action="/MoviesList" method="get" class="search-form-container"> 
					        <input type="text" id="movieSearch" name="movieSearch" 
					               placeholder="영화 제목을 입력해주세요.">
					        
					        <button type="submit" class="search-icon-btn">
					            <i class="fa-solid fa-magnifying-glass" style ="color:gray;"></i>
					        </button>
				    </form>
				</div>
         </div>
	</div>
	
	<div id = "indexMovieList">
	  	 <!-- 개봉중인 영화  -->
		 <div class="slider-container2">
	  		 	<h2><a id = "MainMovieListName" href ="/MoviesList?category=now_playing">현재상영중</a></h2>
			    <button id="prev-btn2" class="nav-btn2"><i class="fas fa-chevron-left"></i></button> 
			  	  <div id="movie-list2"></div>
			    <button id="next-btn2" class="nav-btn2"><i class="fas fa-chevron-right"></i></button> 
		 </div>
	 	 <div id="loading-indicator2">영화 리스트 불러오는중...</div>
	 	 
	 	 <!-- 영화 매거진 슬라이더 -->
         <div class="main-carousel-wrapper">
		    <div class="carousel-container" id="naver-news-list">
		    <button class="arrow-btn prev-btn-news"><i class="fas fa-chevron-left"></i></button>
		        <p>뉴스 데이터를 불러오는 중...</p>
		    <button class="arrow-btn next-btn-news"><i class="fas fa-chevron-right"></i></button>
		    </div>
		</div>
		
		  <!--최고평점-->
		  <div class="slider-container">
		  		<h2><a id= "MainMovieListName" href ="/MoviesList?category=top_rated">최고평점</a></h2>
			    <button id="prev-btn" class="nav-btn"><i class="fas fa-chevron-left"></i></button> 
			    	<div id="movie-list"></div>
			    <button id="next-btn" class="nav-btn"><i class="fas fa-chevron-right"></i></button> 
		  </div>
		  <div id="loading-indicator">영화 리스트 불러오는중...</div>
	</div>
	
	<!--  Url 앵커 : #review-' + ${review.reviewId} -->
	<div class = "slider-container2">	
			<h2 style="color:#e83939;">최신 리뷰</h2>
			<div class="review-container">
					  	<a class="review-card" th:each ="review : ${recentReviews}"
				           th:href="@{/detail/{apiId}(apiId=${review.apiId})} + '#review-' + ${review.reviewId}"
				           style="text-decoration: none; color: black;">
								    <span>[[${review.nickname}]]</span><br>
								  	<b>[[${review.title}]]</b><br>
								    <b id = "comment">"[[${review.comment}]]"</b><br>
								    <span class="rating">
							            <span th:text="${#strings.repeat('⭐', #numbers.formatInteger(review.rating, 0))}"></span>
						        	</span>
								    <span id = "regdate">[[${review.regDate}]]</span>
						</a>
			</div>
	</div>
		<p th:if ="${recentReviews.isEmpty()}">아직 작성된 리뷰가 없습니다.</p>
		
	<!-- -----------------------푸터--------------------------- -->
	
	    <div id = "footer" th:fragment = "footer" style="color:white;">
	    	<a href="/" class="FooterLogo">
	           <img th:src="@{/images/logo.png}" style ="width:100px;" alt ="로고" >
	        </a> 
	        <p style = "color:grey;">리뷰플러스에서 사용된 모든 영화 정보는 
	           <span style ="font-size:15px; font-weight:bold" >
	                  <a href ="https://www.themoviedb.org/" style = "text-decoration: none; font-size :17px;">
	                        TMDb(The Movie Database)
	                  </a> 
	         	</span>통해 제공되었습니다.
	        </p>
	        <p>주소:못골번영로 56번길 8<br>© 2025 ReviewPlus.All Rights Reserved.</p>
	    <button id = "ShowMailForwardingBtn" onClick="openMailModal()">
			문의하기	
		</button>
    <!-- --------------------------------------------------------------------- -->
		<div id = "MailForwarding" style="display:none;">
			<a href="/" class="MailModalLogo">
	           <img th:src="@{/images/logo.png}" style ="width:150px;" alt ="로고" >
	        </a> 
			<form action="/inquiry" method="post" id = "MailForm">
				<span class = "MailCloseBtn">닫기</span>
			    <input type="email" name="email" placeholder="답변 받을 이메일 주소">
			    <input type="text" name="subject" placeholder="문의 제목">
			    <textarea name="content" placeholder = "문의할 계정 이메일,닉네임,성함, 사유를 적어주세요" rows ="5" cols="57"></textarea>
			    <button type="submit"  class="btn-join">문의보내기</button>
			</form>
			<!-- <div th:if="${sucMail}">
					<p th:text= "${sucMail}" style="color: #e84545; font-weight: bold; font-size:17px;"></p>
			</div>
			<div th:if="${failMail}">
					<p th:text= "${failMail}" style="color: red; font-weight: bold; font-size:17px;"></p>
			</div> -->
		</div>
	</div>

<button id="scrollToTopBtn" title="맨 위로" th:fragment ="scroll-to-top">
    <i class="fas fa-arrow-up"></i> </button>

 <!--프로필 사진  -->
 <script src="js/upload.js"></script>
	
 <!-- 영화검색.js -->	
 <script src="js/movie_search.js"></script>
 
 <!-- 푸터 문의하기 -->
 <script src="js/footer.js"></script>
	
 <!--영화 슬라이더 -->
 <script src="js/now_playing.js" type="module"></script>
 <script src="js/top_rate.js" type="module"></script>
 
 <!-- 맨위로가기 -->
 <script src = "/js/scroll-to-top.js"></script>
 
 <!-- 뉴스 슬라이드 효과 -->
 <script src="/js/latest_news.js" defer></script>
 
 
 <script src="https://unpkg.com/flickity@2/dist/flickity.pkgd.min.js"></script>
</body>
</html>